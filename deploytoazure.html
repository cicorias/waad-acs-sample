<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
	<!-- Standard Meta -->
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	<meta name="viewport" content="width=device-width" />

	<!-- Site Properities -->
	<title>Deploying the Website to Windows Azure | Your Website</title>
	<meta name="description" content="A simple example that illustrates how you can use Windows Azure Active Directory (WAAD) and Access Control Service (ACS) to provide both authentication and authorization services to a website hosted using Windows Azure Websites. In brief, a user of the web site will be able to authenticate using either WAAD or another online ID (such as a Microsoft or Google account), rules in ACS will determine the user's role membership, and the website will use the role to control access to pages within the site." />
	<meta name="keywords" content="azure windows active directory access control service WAAD ACS identity authentication authorization" />

	<!-- DocPad Meta -->
	<meta http-equiv="X-Powered-By" content="DocPad v6.46.5"/>

	<!-- DocPad Styles + Our Own -->
	<link  rel="stylesheet" href="./vendor/normalize.css" /><link  rel="stylesheet" href="./vendor/h5bp.css" /><link  rel="stylesheet" href="./styles/style.css" /><link  rel="stylesheet" href="./vendor/tomorrow-night-bright.css" />

	<!-- Icons -->
	<!-- Favicon -->
	<link rel="shortcut icon" href="/icons/favicon.ico" />
	<!-- For non-Retina iPhone, iPod Touch, and Android 2.1+ devices: -->
	<link rel="apple-touch-icon-precomposed" href="icons/apple-touch-icon-57x57-precomposed.png" />
	<!-- For first- and second-generation iPad: -->
	<link rel="apple-touch-icon-precomposed" sizes="72x72" href="icons/apple-touch-icon-72x72-precomposed.png" />
	<!-- For iPhone with high-resolution Retina display: -->
	<link rel="apple-touch-icon-precomposed" sizes="114x114" href="icons/apple-touch-icon-114x114-precomposed.png" />
	<!-- For third-generation iPad with high-resolution Retina display: -->
	<link rel="apple-touch-icon-precomposed" sizes="144x144" href="icons/apple-touch-icon-144x144-precomposed.png" />
</head>
<body>
    <!--[if lt IE 7]>
        <p class="chromeframe">You are using an outdated browser. <a href="http://browsehappy.com/">Upgrade your browser today</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
    <![endif]-->

  <header>
    <nav>
      <li class="fork"><a href="https://github.com/dominicbetts/waad-acs-sample">View On GitHub</a></li>
      <li class="downloads"><a href="https://github.com/dominicbetts/waad-acs-sample/zipball/master">ZIP</a></li>
      <li class="downloads"><a href="https://github.com/dominicbetts/waad-acs-sample/tarball/master">TAR</a></li>
      <li class="title">DOWNLOADS</li>
    </nav>
  </header><!-- end header -->
  
  <div id="header-content">
    <span class="credits left">Project maintained by <a href="https://github.com/dominicbetts">dominicbetts</a></span>
    <span class="credits right">Hosted on GitHub Pages &mdash; Based on theme by <a href="https://twitter.com/michigangraham">mattgraham</a></span>
    <div id="title">
          <h1>WAAD ACS Sample</h1>
          <p>Deploying the Website to Windows Azure</p>
          <hr/>
    </div>
  </div>

  <div class="wrapper">
    <div class="sidebar-left">
      <nav class="pagemenu">
        
          <li class="active">
            <a href="./index.html">
              Welcome
            </a>
          </li>
        
          <li class="active">
            <a href="./prereqs.html">
              Prerequisites
            </a>
          </li>
        
          <li class="active">
            <a href="./overview.html">
              Overview
            </a>
          </li>
        
          <li class="active">
            <a href="./config.html">
              Initial Configuration
            </a>
          </li>
        
          <li class="active">
            <a href="./configwaad.html">
              Configuring WAAD
            </a>
          </li>
        
          <li class="active">
            <a href="./configacs.html">
              Configuring ACS
            </a>
          </li>
        
          <li class="active">
            <a href="./configwebsite.html">
              Configuring the Website
            </a>
          </li>
        
          <li class="inactive">
            <a href="./deploytoazure.html">
              Deploying the Website to Windows Azure
            </a>
          </li>
        
          <li class="active">
            <a href="./identityproviders.html">
              Enabling additional identity providers
            </a>
          </li>
        
      </nav>
    </div>
    <div class="content">
      <section>
        <article>
          <p>After you have run the sample application locally on IIS Express to verify its behavior, you may want to deploy it to Windows Azure Web Sites. This way you&#39;ll have everything hosted in the cloud.</p>
<h3>Create a Windows Azure Web Site</h3>
<p>Follow the instructions in the section <strong>Create a web site</strong> on the page <a href="http://www.windowsazure.com/en-us/develop/net/tutorials/get-started">Deploying an ASP.NET Web Application to a Windows Azure Web Site</a> in the Windows Azure online documentation to create an empty website in your Windows Azure subscription that you can use to deploy the sample.</p>
<h3>Deploy the sample web site</h3>
<p>Follow the instructions in the section <strong>Deploy the application to Windows Azure</strong> on the page <a href="http://www.windowsazure.com/en-us/develop/net/tutorials/get-started">Deploying an ASP.NET Web Application to a Windows Azure Web Site</a> in the Windows Azure online documentation to deploy the sample application to your Windows Azure website.</p>
<h3>Update the Return URL in the Access Control Service Relying Party</h3>
<p>After Access Control Service has received the claims from its identity provider and processed any rules, it must forward the resulting set of claims to the web application that is now hosted in Windows Azure web sites.</p>
<p><img src="https://raw.github.com/dominicbetts/waad-acs-sample/master/images/website_rp.png" alt="Updated Return URL"></p>
<p><strong>Note:</strong> You don&#39;t need to change the <strong>Realm</strong> unless you also change the value of the <strong>audienceUris</strong> setting in the web.config file: as long as these two values match the handshake between the web application and ACS will work.</p>
<p>You could also use this PowerShell script (available <a href="https://github.com/dominicbetts/waad-acs-sample/blob/master/scripts/ChangeReturnURL.ps1">here</a>) to change the return URL:</p>
<pre class="highlighted"><code class="php"><span class="comment"># Prerequisites:</span>
<span class="comment"># Windows Azure PowerShell (http://go.microsoft.com/?linkid=9811175)</span>

<span class="comment"># You must provide: </span>
<span class="comment"># - The new return URL for your relying party</span>
<span class="comment"># - Your ACS namespace name</span>
<span class="comment"># - Your ACS management key</span>
<span class="comment"># - The ACS name for your relying party</span>


<span class="comment"># To work with ACS</span>
Import-Module WAPPSCmdlets

<span class="variable">$AppAddress</span> = <span class="string">'[the new return URL for your application]'</span>
<span class="variable">$ACSNamespace</span> = <span class="string">'[your ACS namespace name]'</span>
<span class="variable">$ACSManagementkey</span> = <span class="string">'[your ACS Management Key]'</span>
<span class="variable">$RelyingPartyName</span> = <span class="string">'[the name of your relying party in ACS]'</span>

<span class="comment">#  Change the return URL for your relying party</span>
<span class="variable">$relyingParty</span> = Get-RelyingParty -ManagementKey <span class="variable">$ACSManagementkey</span> -Name <span class="variable">$RelyingPartyName</span> -<span class="keyword">Namespace</span> <span class="variable">$ACSNamespace</span>
<span class="variable">$relyingParty</span>.ReturnUrl = <span class="variable">$AppAddress</span>
Remove-RelyingParty -Name <span class="variable">$RelyingPartyName</span> -ManagementKey <span class="variable">$ACSManagementkey</span> -<span class="keyword">Namespace</span> <span class="variable">$ACSNamespace</span>
Add-RelyingParty -RelyingParty <span class="variable">$relyingParty</span> -ManagementKey <span class="variable">$ACSManagementkey</span> -<span class="keyword">Namespace</span> <span class="variable">$ACSNamespace</span></code></pre>

        </article>
      
      </section>
    </div>
  </div>

  <footer>
  </footer><!-- end footer -->  

	<!-- jQuery -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="/vendor/jquery.js"><\/script>')</script>

	<!-- DocPad Scripts + Our Own -->
	<script defer="defer"  src="./vendor/log.js"></script><script defer="defer"  src="./vendor/modernizr.js"></script><script defer="defer"  src="./scripts/script.js"></script>
</body>
</html>